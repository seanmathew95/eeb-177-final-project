# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/eeb177-final-project/PyRate/new-pyrate-run/pyrate_mcmc_logs/felidae_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/eeb177-final-project/PyRate/new-pyrate-run/pyrate_mcmc_logs/felidae_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.166988161504, 0.166988161504,0.166988161504,0.166988161504,0.166988161504,0.166988161504,0.17009005434,0.170891764459,0.17009005434,0.166988161504,0.166988161504,0.16491256496,0.166872511633,0.166872511633,0.16088840864,0.159603298383,0.16088840864,0.158996523343,0.158047742136,0.15659941693,0.15659941693,0.152559176089,0.136277500008,0.136277500008,0.12675034519,0.12675034519,0.12675034519,0.12675034519,0.12675034519,0.12675034519,0.12675034519)
L_hpd_M95=c(0.245904114464, 0.245904114464,0.245904114464,0.245904114464,0.245904114464,0.245904114464,0.247291782633,0.247291782633,0.247291782633,0.245743310731,0.246727930122,0.247291782633,0.252630073031,0.254710169114,0.256264427468,0.256264427468,0.256264427468,0.256264427468,0.256264427468,0.254710169114,0.256264427468,0.263497219547,0.289325901886,0.310641433971,0.30588051506,0.30588051506,0.30588051506,0.30588051506,0.30588051506,0.30588051506,0.30588051506)
M_hpd_m95=c(0.581452487826, 0.581452487826,0.0805855865577,0.0805855865577,0.0805855865577,0.0795796770283,0.0805855865577,0.0795796770283,0.0807681191646,0.0807681191646,0.0720764236848,0.0748726408588,0.0623448642672,0.0325272782714,0.017145243657,0.00849045303579,0.00607875603093,0.00652270126,0.00607875603093,0.00496907770277,0.00459570688025,0.00354771051433,0.00354771051433,0.00354771051433,0.00354771051433,0.00354771051433,0.00354771051433,0.00354771051433,0.00354771051433,0.00354771051433,0.00354771051433)
M_hpd_M95=c(1.12872780768, 1.12872780768,0.15720612632,0.15720612632,0.15720612632,0.157683979763,0.159442068861,0.159878529474,0.162355151793,0.164680772202,0.159229073739,0.164680772202,0.165197847844,0.164564732213,0.152173145222,0.139787851026,0.123400963545,0.119414071688,0.116393478899,0.109770118953,0.107280874156,0.104199762826,0.104199762826,0.104199762826,0.104199762826,0.104199762826,0.104199762826,0.104199762826,0.104199762826,0.104199762826,0.104199762826)
R_hpd_m95=c(-0.919975865641, -0.919975865641,0.0327243468761,0.0327243468761,0.0327243468761,0.0357402357711,0.0357402357711,0.0353737101998,0.0335349601658,0.0353737101998,0.0294061226547,0.0198257985624,0.0165786159792,0.0177329787352,0.0306970000815,0.0439640658029,0.0711962661956,0.0729592889291,0.0736545624683,0.082269404674,0.0823291833332,0.0804829181204,0.0736545624683,0.0714080809654,0.0714080809654,0.0714080809654,0.0714080809654,0.0714080809654,0.0714080809654,0.0714080809654,0.0714080809654)
R_hpd_M95=c(-0.373987978485, -0.373987978485,0.146798530317,0.146798530317,0.146798530317,0.147485047726,0.147485047726,0.147816858168,0.147485047726,0.152501319471,0.151590220433,0.150409585247,0.156020407405,0.186870237964,0.205434163577,0.215957456886,0.225953637754,0.221243594889,0.221474592917,0.227026596718,0.22624985097,0.23144423325,0.272294353794,0.280092339321,0.280092339321,0.280092339321,0.280092339321,0.280092339321,0.280092339321,0.280092339321,0.280092339321)
L_mean=c(0.209456213213, 0.209456213213,0.209504939046,0.20946632012,0.20946632012,0.209495681746,0.209263546041,0.20901801414,0.208834547836,0.20854986702,0.208095265586,0.207381404643,0.206382204272,0.205988749672,0.20515170863,0.205038849839,0.205186263081,0.205142874975,0.205218961611,0.205342601662,0.206416921737,0.210298739034,0.220750287814,0.222236489184,0.222396716256,0.22244065709,0.22244065709,0.22244065709,0.22244065709,0.22244065709,0.22244065709)
M_mean=c(0.849710988952, 0.849710988952,0.116635167268,0.11663595129,0.116635380908,0.117387030238,0.117620709162,0.118244062383,0.118552817731,0.118275364255,0.118252011063,0.117709930854,0.116042824588,0.10758678487,0.0930261539962,0.0733615635137,0.057396755183,0.0542347915087,0.0508604699303,0.0477880548134,0.0462767796659,0.0458949142055,0.0458949142055,0.0458949142055,0.0458949142055,0.0458949142055,0.0458949142055,0.0458949142055,0.0458949142055,0.0458949142055,0.0458949142055)
R_mean=c(-0.640254775738, -0.640254775738,0.0928697717778,0.0928303688299,0.0928309392117,0.0921086515081,0.0916428368785,0.0907739517568,0.0902817301046,0.0902745027646,0.0898432545232,0.0896714737895,0.0903393796843,0.0984019648015,0.112125554634,0.131677286325,0.147789507898,0.150908083466,0.154358491681,0.157554546849,0.160140142071,0.164403824828,0.174855373609,0.176341574979,0.176501802051,0.176545742885,0.176545742885,0.176545742885,0.176545742885,0.176545742885,0.176545742885)
trans=0.5
age=(0:(31-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.341705577368), xlim = c(-32.55,1.55), ylab = 'Speciation rate', xlab = 'Ma',main='felidae' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.24160058845), xlim = c(-32.55,1.55), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.0119734522, 0.308101573253), xlim = c(-32.55,1.55), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-32.55,1.55), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()